# COVID-19 è¿½è¸ªå™¨ ğŸ¦ 

ä¸€ä¸ªä½¿ç”¨Flutterå¼€å‘çš„COVID-19ç–«æƒ…è¿½è¸ªåº”ç”¨ï¼Œé‡‡ç”¨ä¼ä¸šçº§æ¶æ„å’Œç°ä»£åŒ–æŠ€æœ¯æ ˆã€‚æœ¬é¡¹ç›®ä¸ä»…é€‚åˆåˆå­¦è€…å­¦ä¹ Flutterå¼€å‘ï¼Œæ›´æ˜¯ä¸€ä»½å®Œæ•´çš„ä¼ä¸šçº§Flutteråº”ç”¨æœ€ä½³å®è·µå‚è€ƒã€‚

**é¡¹ç›®çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª | ğŸ—ï¸ æ¶æ„å·²ä¼˜åŒ– | ğŸ“± è·¨å¹³å°æ”¯æŒ

---

## ğŸ“š å®Œæ•´å¼€å‘æŒ‡å—ï¼šä»ç½‘ç»œæ•°æ®åˆ°ç•Œé¢ç»˜åˆ¶

æœ¬æ–‡æ¡£æä¾›**è¯¦ç»†çš„ç«¯åˆ°ç«¯ç¤ºä¾‹**ï¼Œå¸¦ä½ å®Œæ•´ä½“éªŒä»ç½‘ç»œè¯·æ±‚ â†’ æ•°æ®å¤„ç† â†’ çŠ¶æ€ç®¡ç† â†’ UIå±•ç¤ºçš„å®Œæ•´å¼€å‘æµç¨‹ã€‚

---

## å®Œæ•´ç¤ºä¾‹ï¼šæ˜¾ç¤ºå…¨çƒç–«æƒ…ç»Ÿè®¡æ•°æ®

### ç¤ºä¾‹ç›®æ ‡

å®ç°ä¸€ä¸ªé¡µé¢ï¼Œæ˜¾ç¤ºå…¨çƒCOVID-19ç»Ÿè®¡æ•°æ®ï¼š
- ä»ç½‘ç»œAPIè·å–æ•°æ®
- å¤„ç†å„ç§é”™è¯¯æƒ…å†µ
- æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- å±•ç¤ºæ•°æ®å¡ç‰‡

### å®Œæ•´æµç¨‹å›¾ï¼ˆ2026 Riverpod Generator æ¶æ„ï¼‰

```
ç”¨æˆ·æ‰“å¼€é¡µé¢
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬1æ­¥ï¼šå®šä¹‰æ•°æ®å±‚ï¼ˆRepositoryï¼‰                          â”‚
â”‚ ç½‘ç»œè¯·æ±‚ + é”™è¯¯å¤„ç†                                       â”‚
â”‚ lib/repositories/covid_repository.dart                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬2æ­¥ï¼šå®šä¹‰çŠ¶æ€ç®¡ç†ï¼ˆ@riverpod æ³¨è§£ï¼‰                     â”‚
â”‚ ç®¡ç†å¼‚æ­¥çŠ¶æ€ + è‡ªåŠ¨ç”Ÿæˆ Provider                          â”‚
â”‚ lib/notifiers/global_stats_notifier.dart                 â”‚
â”‚ lib/router.dart                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬3æ­¥ï¼šåˆ›å»ºUIé¡µé¢ï¼ˆScreenï¼‰                              â”‚
â”‚ ä½¿ç”¨ç”Ÿæˆçš„ Provider                                       â”‚
â”‚ lib/screens/global_stats_screen.dart                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„ä¼˜åŠ¿

**ä¼ ç»Ÿ Riverpod vs Riverpod Generatorï¼š**

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹å¼ | Generator æ–¹å¼ |
|------|---------|---------------|
| ä»£ç é‡ | 70+ è¡Œæ‰‹åŠ¨å£°æ˜ | 3 è¡Œæ³¨è§£ |
| ç±»å‹å®‰å…¨ | è¿è¡Œæ—¶æ£€æŸ¥ | ç¼–è¯‘æ—¶æ£€æŸ¥ |
| ä¾èµ–æ³¨å…¥ | æ‰‹åŠ¨æ„é€ å‡½æ•° | è‡ªåŠ¨ `ref.read()` |
| ç»´æŠ¤æˆæœ¬ | é«˜ï¼ˆå®¹æ˜“å‡ºé”™ï¼‰ | ä½ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ |

---

## ç¬¬1æ­¥ï¼šå®šä¹‰æ•°æ®å±‚ï¼ˆRepositoryï¼‰

### 1.1 å®šä¹‰æ¥å£ï¼ˆæŠ½è±¡ï¼‰

**æ–‡ä»¶**: `lib/repositories/covid_repository.dart`

```dart
/// COVID-19 æ•°æ®ä»“åº“æ¥å£
///
/// å®šä¹‰æ•°æ®è®¿é—®çš„æŠ½è±¡å±‚ï¼Œä¾¿äºæµ‹è¯•å’ŒMock
abstract class CovidRepository {
  /// è·å–å…¨çƒç»Ÿè®¡æ•°æ®
  Future<Map<String, dynamic>> getGlobalData();
  
  /// è·å–æ‰€æœ‰å›½å®¶æ•°æ®
  Future<List<dynamic>> getAllCountries();
  
  /// è·å–æŒ‡å®šå›½å®¶å†å²æ•°æ®
  Future<Map<String, dynamic>> getHistoricalData(String country);
}
```

### 1.2 å®ç°æ•°æ®å±‚ï¼ˆå«é”™è¯¯å¤„ç†ï¼‰

**æ–‡ä»¶**: `lib/repositories/covid_repository.dart`ï¼ˆæ¥å£å’Œå®ç°åœ¨åŒä¸€æ–‡ä»¶ï¼‰

```dart
import 'package:logger/logger.dart';
import 'package:dio/dio.dart';
import '../core/errors/app_error.dart';
import '../core/network/dio_client.dart';
import '../config/app_config.dart';

/// ä»“åº“å®ç°ç±» - åŒ…å«é”™è¯¯å¤„ç†
class CovidRepositoryImpl implements CovidRepository {
  final Logger _logger;

  CovidRepositoryImpl(this._logger);

  @override
  Future<Map<String, dynamic>> getGlobalData() async {
    _logger.i('ğŸŒ å¼€å§‹è·å–å…¨çƒæ•°æ®');
    try {
      final response = await DioClient.dio.get(
        AppConfig.endpointGlobal,
      );
      final data = response.data as Map<String, dynamic>;

      _logger.i('âœ… å…¨çƒæ•°æ®è·å–æˆåŠŸï¼Œç—…ä¾‹æ•°: ${data['cases']}');
      return data;
    } on DioException catch (e) {
      _logger.e('âŒ ç½‘ç»œè¯·æ±‚å¤±è´¥: $e');
      // è½¬æ¢ä¸ºå…·ä½“é”™è¯¯ç±»å‹
      throw ErrorHandler.handleDioError(e);
    } catch (e) {
      _logger.e('âŒ æœªçŸ¥é”™è¯¯: $e');
      throw ErrorHandler.handleError(e);
    }
  }

  // å…¶ä»–æ–¹æ³•å®ç°...
  @override
  Future<List<dynamic>> getAllCountries() async {
    _logger.i('å¼€å§‹è·å–å›½å®¶åˆ—è¡¨');
    try {
      final response = await DioClient.dio.get(
        AppConfig.endpointCountries(),
      );
      final data = response.data as List<dynamic>;
      _logger.i('å›½å®¶åˆ—è¡¨è·å–æˆåŠŸï¼Œæ•°é‡: ${data.length}');
      return data;
    } on DioException catch (e) {
      throw ErrorHandler.handleDioError(e);
    }
  }

  @override
  Future<Map<String, dynamic>> getHistoricalData(String country) async {
    _logger.i('å¼€å§‹è·å– $country çš„å†å²æ•°æ®');
    try {
      final response = await DioClient.dio.get(
        AppConfig.endpointHistorical(country),
      );
      final data = response.data as Map<String, dynamic>;
      _logger.i('$country å†å²æ•°æ®è·å–æˆåŠŸ');
      return data;
    } on DioException catch (e) {
      throw ErrorHandler.handleDioError(e);
    }
  }
}
```

**å…³é”®è¦ç‚¹**:
- âœ… ä½¿ç”¨ `DioException` æ•è·ç½‘ç»œé”™è¯¯
- âœ… ä½¿ç”¨ `ErrorHandler` è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„é”™è¯¯
- âœ… æ—¥å¿—è®°å½•å®Œæ•´çš„æ•°æ®æµå‘

---

## ç¬¬2æ­¥ï¼šå®šä¹‰çŠ¶æ€ç®¡ç†ï¼ˆRiverpod Generatorï¼‰

### 2.1 æ ¸å¿ƒä¾èµ– Providerï¼ˆrouter.dartï¼‰

**æ–‡ä»¶**: `lib/router.dart`

```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';
import 'package:logger/logger.dart';
import 'repositories/covid_repository.dart';
import 'config/app_config.dart';

part 'router.g.dart';

/// Logger Provider - è‡ªåŠ¨ç”Ÿæˆ
@riverpod
Logger logger(Ref ref) {
  return Logger(
    level: AppConfig.enableLogging ? Level.trace : Level.off,
    printer: PrettyPrinter(
      methodCount: 0,
      errorMethodCount: 5,
      lineLength: 50,
      colors: true,
      printEmojis: true,
    ),
  );
}

/// Repository Provider - è‡ªåŠ¨ç”Ÿæˆ
@riverpod
CovidRepository covidRepository(Ref ref) {
  return CovidRepositoryImpl(ref.read(loggerProvider));
}
```

### 2.2 åˆ›å»º AsyncNotifierï¼ˆæ³¨è§£æ–¹å¼ï¼‰

**æ–‡ä»¶**: `lib/notifiers/global_stats_notifier.dart`

```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';
import '../router.dart';

part 'global_stats_notifier.g.dart';

/// å…¨çƒç»Ÿè®¡æ•°æ®çŠ¶æ€ç®¡ç†å™¨ï¼ˆRiverpod Generator ç‰ˆæœ¬ï¼‰
///
/// ä½¿ç”¨ @riverpod æ³¨è§£ï¼Œä»£ç ç”Ÿæˆå™¨è‡ªåŠ¨ç”Ÿæˆ Provider
/// æ¯”ä¼ ç»Ÿæ–¹å¼å‡å°‘ 70% æ ·æ¿ä»£ç 
@riverpod
class GlobalStats extends _$GlobalStats {
  @override
  Future<Map<String, dynamic>> build() async {
    // è‡ªåŠ¨ç”Ÿæˆ refï¼Œç›´æ¥ä½¿ç”¨
    ref.read(loggerProvider).i('å¼€å§‹åŠ è½½å…¨çƒæ•°æ®');
    
    final globalData = await ref.read(covidRepositoryProvider).getGlobalData();
    return {
      'global': globalData,
      'historical': null,
    };
  }

  /// åŠ è½½å…¨çƒå’Œå†å²æ•°æ®
  Future<void> loadAll(String country) async {
    state = const AsyncValue.loading();
    state = await AsyncValue.guard(() async {
      final results = await Future.wait<Map<String, dynamic>>([
        ref.read(covidRepositoryProvider).getGlobalData(),
        ref.read(covidRepositoryProvider).getHistoricalData(country),
      ]);
      return {
        'global': results[0],
        'historical': results[1],
      };
    });
  }

  /// åˆ·æ–°æ•°æ®
  Future<void> refresh() async {
    final currentData = state.valueOrNull;
    final hasHistorical = currentData?['historical'] != null;

    if (hasHistorical) {
      await loadAll('China');
    } else {
      state = const AsyncValue.loading();
      state = await AsyncValue.guard(() async {
        final globalData = await ref.read(covidRepositoryProvider).getGlobalData();
        return {
          'global': globalData,
          'historical': null,
        };
      });
    }
  }
}
```

**å…³é”®è¦ç‚¹**:
- âœ… ä½¿ç”¨ `@riverpod` æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆ Provider
- âœ… `ref` è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€å£°æ˜
- âœ… ä½¿ç”¨ `AsyncValue.guard()` ç®€åŒ–é”™è¯¯å¤„ç†
- âœ… ç”Ÿæˆçš„ Provider åç§°ï¼š`globalStatsProvider`

### 2.3 ä»£ç ç”Ÿæˆ

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆä»£ç ï¼š

```bash
# ç”Ÿæˆä»£ç ï¼ˆé¦–æ¬¡æˆ–ä¿®æ”¹åè¿è¡Œï¼‰
flutter pub run build_runner build --delete-conflicting-outputs

# ç›‘å¬æ¨¡å¼ï¼ˆå¼€å‘æ—¶è‡ªåŠ¨é‡æ–°ç”Ÿæˆï¼‰
flutter pub run build_runner watch --delete-conflicting-outputs
```

ç”Ÿæˆçš„æ–‡ä»¶ï¼š
- `router.g.dart` - åŒ…å« `loggerProvider`, `covidRepositoryProvider`, `routerProvider`
- `global_stats_notifier.g.dart` - åŒ…å« `globalStatsProvider`
- `country_list_notifier.g.dart` - åŒ…å« `countriesProvider`

---

## ç¬¬3æ­¥ï¼šåˆ›å»ºUIé¡µé¢ï¼ˆScreenï¼‰

### 3.1 å®ç°å®Œæ•´çš„UIé¡µé¢

**æ–‡ä»¶**: `lib/screens/global_stats_screen.dart`

```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../core/errors/app_error.dart';
import '../notifiers/global_stats_notifier.dart';
import '../router.dart';

/// å…¨çƒç–«æƒ…ç»Ÿè®¡æ¼”ç¤ºé¡µé¢
///
/// å±•ç¤ºå®Œæ•´çš„ä»ç½‘ç»œåˆ°UIçš„æµç¨‹ï¼š
/// 1. åŠ è½½çŠ¶æ€æ˜¾ç¤º
/// 2. æ•°æ®å±•ç¤ºï¼ˆå¡ç‰‡å½¢å¼ï¼‰
/// 3. é”™è¯¯å¤„ç†ï¼ˆä¸åŒç±»å‹é”™è¯¯ä¸åŒæç¤ºï¼‰
/// 4. ä¸‹æ‹‰åˆ·æ–°
class GlobalStatsDemoScreen extends ConsumerWidget {
  const GlobalStatsDemoScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // ç›‘å¬çŠ¶æ€
    final statsAsync = ref.watch(globalStatsProvider);

    return Scaffold(
      appBar: AppBar(
        title: const Text('å…¨çƒç–«æƒ…æ•°æ®'),
        centerTitle: true,
        actions: [
          // åˆ·æ–°æŒ‰é’®
          IconButton(
            icon: const Icon(Icons.refresh),
            onPressed: () {
              ref.read(globalStatsProvider.notifier).refresh();
            },
          ),
        ],
      ),
      body: RefreshIndicator(
        // ä¸‹æ‹‰åˆ·æ–°å›è°ƒ
        onRefresh: () async {
          await ref.read(globalStatsProvider.notifier).refresh();
        },
        // æ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒUI
        child: statsAsync.when(
          // æ•°æ®åŠ è½½æˆåŠŸ
          data: (data) => _buildDataView(context, data),
          // åŠ è½½ä¸­
          loading: () => _buildLoadingView(),
          // åŠ è½½å¤±è´¥
          error: (error, stackTrace) => _buildErrorView(
            context, 
            error as AppError,
            ref,
          ),
        ),
      ),
    );
  }

  /// æ„å»ºæ•°æ®å±•ç¤ºè§†å›¾
  Widget _buildDataView(BuildContext context, Map<String, dynamic> data) {
    return SingleChildScrollView(
      physics: const AlwaysScrollableScrollPhysics(),
      padding: const EdgeInsets.all(16.0),
      child: Column(
        children: [
          // æ ‡é¢˜
          const Text(
            'ğŸŒ å…¨çƒ COVID-19 ç»Ÿè®¡',
            style: TextStyle(
              fontSize: 24,
              fontWeight: FontWeight.bold,
            ),
          ),
          const SizedBox(height: 20),
          
          // ç»Ÿè®¡å¡ç‰‡ç½‘æ ¼
          GridView.count(
            shrinkWrap: true,
            physics: const NeverScrollableScrollPhysics(),
            crossAxisCount: 2,
            mainAxisSpacing: 16,
            crossAxisSpacing: 16,
            childAspectRatio: 1.2,
            children: [
              _buildStatCard(
                'æ€»ç¡®è¯Š',
                data['cases']?.toString() ?? '0',
                Colors.blue,
                Icons.coronavirus,
              ),
              _buildStatCard(
                'æ­»äº¡',
                data['deaths']?.toString() ?? '0',
                Colors.red,
                Icons.heart_broken,
              ),
              _buildStatCard(
                'åº·å¤',
                data['recovered']?.toString() ?? '0',
                Colors.green,
                Icons.healing,
              ),
              _buildStatCard(
                'æ´»è·ƒ',
                data['active']?.toString() ?? '0',
                Colors.orange,
                Icons.local_hospital,
              ),
            ],
          ),
          
          const SizedBox(height: 30),
          
          // æ›´å¤šè¯¦æƒ…
          _buildDetailCard(data),
        ],
      ),
    );
  }

  /// æ„å»ºç»Ÿè®¡å¡ç‰‡
  Widget _buildStatCard(
    String title, 
    String value, 
    Color color,
    IconData icon,
  ) {
    return Card(
      elevation: 4,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      child: Container(
        decoration: BoxDecoration(
          borderRadius: BorderRadius.circular(16),
          gradient: LinearGradient(
            colors: [
              color.withOpacity(0.8),
              color.withOpacity(0.4),
            ],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        padding: const EdgeInsets.all(16),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(icon, size: 32, color: Colors.white),
            const SizedBox(height: 8),
            Text(
              title,
              style: const TextStyle(
                color: Colors.white,
                fontSize: 14,
                fontWeight: FontWeight.w500,
              ),
            ),
            const SizedBox(height: 4),
            Text(
              value,
              style: const TextStyle(
                color: Colors.white,
                fontSize: 20,
                fontWeight: FontWeight.bold,
              ),
              maxLines: 1,
              overflow: TextOverflow.ellipsis,
            ),
          ],
        ),
      ),
    );
  }

  /// æ„å»ºè¯¦æƒ…å¡ç‰‡
  Widget _buildDetailCard(Map<String, dynamic> data) {
    return Card(
      elevation: 2,
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const Text(
              'ğŸ“Š è¯¦ç»†ç»Ÿè®¡',
              style: TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.bold,
              ),
            ),
            const SizedBox(height: 12),
            _buildDetailRow('ä»Šæ—¥æ–°å¢', data['todayCases']?.toString() ?? '0'),
            _buildDetailRow('ä»Šæ—¥æ­»äº¡', data['todayDeaths']?.toString() ?? '0'),
            _buildDetailRow('å—å½±å“å›½å®¶', data['affectedCountries']?.toString() ?? '0'),
            _buildDetailRow('æ£€æµ‹æ¬¡æ•°', data['tests']?.toString() ?? '0'),
          ],
        ),
      ),
    );
  }

  /// æ„å»ºè¯¦æƒ…è¡Œ
  Widget _buildDetailRow(String label, String value) {
    return Padding(
      padding: const EdgeInsets.symmetric(vertical: 4),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.spaceBetween,
        children: [
          Text(label, style: TextStyle(color: Colors.grey[400])),
          Text(
            value,
            style: const TextStyle(fontWeight: FontWeight.bold),
          ),
        ],
      ),
    );
  }

  /// æ„å»ºåŠ è½½è§†å›¾
  Widget _buildLoadingView() {
    return const Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          CircularProgressIndicator(),
          SizedBox(height: 16),
          Text('æ­£åœ¨åŠ è½½å…¨çƒç–«æƒ…æ•°æ®...'),
        ],
      ),
    );
  }

  /// æ„å»ºé”™è¯¯è§†å›¾ï¼ˆæ”¯æŒä¸åŒç±»å‹é”™è¯¯ä¸åŒæç¤ºï¼‰
  Widget _buildErrorView(
    BuildContext context, 
    AppError error, 
    WidgetRef ref,
  ) {
    // æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒå›¾æ ‡å’Œæç¤º
    IconData icon;
    String subtitle;
    
    switch (error.runtimeType) {
      case NetworkError:
        icon = Icons.wifi_off;
        subtitle = 'è¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥';
        break;
      case ServerError:
        icon = Icons.cloud_off;
        subtitle = 'æœåŠ¡å™¨æš‚æ—¶ä¸å¯ç”¨';
        break;
      case TimeoutError:
        icon = Icons.timer_off;
        subtitle = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•';
        break;
      default:
        icon = Icons.error_outline;
        subtitle = 'å‘ç”ŸæœªçŸ¥é”™è¯¯';
    }

    return Center(
      child: Padding(
        padding: const EdgeInsets.all(24.0),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(icon, size: 64, color: Colors.red[300]),
            const SizedBox(height: 16),
            Text(
              error.message,
              style: const TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.bold,
              ),
              textAlign: TextAlign.center,
            ),
            const SizedBox(height: 8),
            Text(
              subtitle,
              style: TextStyle(
                fontSize: 14,
                color: Colors.grey[400],
              ),
              textAlign: TextAlign.center,
            ),
            const SizedBox(height: 24),
            ElevatedButton.icon(
              onPressed: () {
                ref.read(globalStatsProvider.notifier).refresh();
              },
              icon: const Icon(Icons.refresh),
              label: const Text('é‡æ–°åŠ è½½'),
            ),
          ],
        ),
      ),
    );
  }
}
```

**å…³é”®è¦ç‚¹**:
- âœ… ä½¿ç”¨ `ConsumerWidget` ç›‘å¬çŠ¶æ€å˜åŒ–
- âœ… `AsyncValue.when()` å¤„ç†ä¸‰ç§çŠ¶æ€
- âœ… æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒæç¤º
- âœ… ä¸‹æ‹‰åˆ·æ–°é›†æˆ
- âœ… å“åº”å¼ç½‘æ ¼å¸ƒå±€

---

## ç¬¬4æ­¥ï¼šåº”ç”¨å…¥å£é…ç½®

### 4.1 æ›´æ–° main.dart

**æ–‡ä»¶**: `lib/main.dart`

```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_dotenv/flutter_dotenv.dart';
import 'config/app_config.dart';
import 'core/network/dio_client.dart';
import 'router.dart';

Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // 1ï¸âƒ£ åŠ è½½ç¯å¢ƒå˜é‡
  await dotenv.load(fileName: '.env');
  
  runApp(
    const ProviderScope(
      child: AppInitializer(),
    ),
  );
}

/// åº”ç”¨åˆå§‹åŒ–å™¨
/// é…ç½®å…¨å±€æœåŠ¡
class AppInitializer extends ConsumerWidget {
  const AppInitializer({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // 2ï¸âƒ£ é…ç½® Loggerï¼ˆä»ç”Ÿæˆçš„ Provider è·å–ï¼‰
    final logger = ref.watch(loggerProvider);
    
    // 3ï¸âƒ£ é…ç½® DioClientï¼ˆä»…åœ¨å¯ç”¨æ—¥å¿—æ—¶ï¼‰
    if (AppConfig.enableLogging) {
      DioClient.configure(logger);
    }
    
    return const MyApp();
  }
}

/// ä¸»åº”ç”¨
class MyApp extends ConsumerWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // ä½¿ç”¨ç”Ÿæˆçš„ Provider
    final theme = ref.watch(themeProvider);
    final router = ref.watch(routerProvider);

    return MaterialApp.router(
      title: 'COVID-19 è¿½è¸ªå™¨',
      debugShowCheckedModeBanner: false,
      theme: theme,
      routerConfig: router,
    );
  }
}
```

---

## å®Œæ•´è¿è¡Œæµç¨‹æ¼”ç¤º

### åœºæ™¯ï¼šæ­£å¸¸åŠ è½½æ•°æ®

```
1. ç”¨æˆ·æ‰“å¼€é¡µé¢
   â””â”€> GlobalStatsNotifier æ„é€ å‡½æ•°è°ƒç”¨ loadGlobalData()

2. å‘èµ·ç½‘ç»œè¯·æ±‚
   â””â”€> DioClient è¯·æ±‚ https://disease.sh/v3/covid-19/all
   â””â”€> Logger è¾“å‡º: "ğŸŒ å¼€å§‹è·å–å…¨çƒæ•°æ®"

3. è¯·æ±‚æˆåŠŸ
   â””â”€> Logger è¾“å‡º: "âœ… å…¨çƒæ•°æ®è·å–æˆåŠŸ"
   â””â”€> Notifier æ›´æ–° state = AsyncValue.data(data)

4. UI è‡ªåŠ¨é‡å»º
   â””â”€> æ˜¾ç¤ºæ•°æ®å¡ç‰‡
   â””â”€> æ˜¾ç¤ºç—…ä¾‹æ•°ã€æ­»äº¡æ•°ã€åº·å¤æ•°ã€æ´»è·ƒæ•°
```

### åœºæ™¯ï¼šç½‘ç»œé”™è¯¯

```
1. å‘èµ·ç½‘ç»œè¯·æ±‚
   â””â”€> DioException: connectionTimeout

2. Repository æ•è·é”™è¯¯
   â””â”€> ErrorHandler è½¬æ¢ä¸º TimeoutError

3. Notifier æ›´æ–°çŠ¶æ€
   â””â”€> state = AsyncValue.error(TimeoutError(), stackTrace)

4. UI æ˜¾ç¤ºé”™è¯¯é¡µé¢
   â””â”€> æ˜¾ç¤ºè¶…æ—¶å›¾æ ‡
   â””â”€> æ˜¾ç¤º"è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•"
   â””â”€> æä¾›"é‡æ–°åŠ è½½"æŒ‰é’®
```

---

## å¼€å‘è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹æ—¥å¿—è¾“å‡º

```bash
# è¿è¡Œåº”ç”¨ï¼ˆæ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ï¼‰
flutter run

# è¿‡æ»¤æŸ¥çœ‹ç‰¹å®šæ—¥å¿—
flutter run | grep "å…¨çƒæ•°æ®"
```

**æ—¥å¿—ç¤ºä¾‹**:
```
[GlobalStatsNotifier] ğŸ”„ å¼€å§‹åŠ è½½å…¨çƒæ•°æ®
[CovidRepositoryImpl] âœ… å…¨çƒæ•°æ®è·å–æˆåŠŸ
[GlobalStatsNotifier] âœ… å…¨çƒæ•°æ®åŠ è½½å®Œæˆ
```

### æµ‹è¯•ä¸åŒåœºæ™¯

```dart
// åœ¨ Repository ä¸­æ¨¡æ‹Ÿé”™è¯¯æ¥æµ‹è¯•é”™è¯¯å¤„ç†
try {
  // æ¨¡æ‹Ÿç½‘ç»œé”™è¯¯
  // throw DioException(requestOptions: RequestOptions(), type: DioExceptionType.connectionTimeout);
  
  // æ¨¡æ‹ŸæœåŠ¡å™¨é”™è¯¯
  // throw DioException(requestOptions: RequestOptions(), response: Response(statusCode: 500));
  
  final response = await DioClient.dio.get(AppConfig.endpointGlobal);
  // ...
}
```

---

## æ€»ç»“

### å®Œæ•´æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UIå±‚      â”‚â”€â”€â”€â”€â–¶â”‚  Provider    â”‚â”€â”€â”€â”€â–¶â”‚  Notifier    â”‚
â”‚  (Screen)   â”‚â—€â”€â”€â”€â”€â”‚  (Riverpod)  â”‚â—€â”€â”€â”€â”€â”‚  (Business)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚  Repository  â”‚
                                         â”‚  (Dataå±‚)    â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚  API (Dio)  â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒåŸåˆ™

1. **å•ä¸€èŒè´£**: æ¯å±‚åªåšä¸€ä»¶äº‹
2. **ä¾èµ–æ³¨å…¥**: é€šè¿‡ Riverpod ç®¡ç†ä¾èµ–
3. **é”™è¯¯åˆ†ç±»**: ä¸åŒé”™è¯¯ä¸åŒå¤„ç†
4. **å“åº”å¼UI**: çŠ¶æ€é©±åŠ¨ç•Œé¢æ›´æ–°

---

**ğŸ‰ æ­å–œï¼ä½ å·²ç»æŒæ¡äº†ä¼ä¸šçº§Flutterå¼€å‘çš„å®Œæ•´æµç¨‹ï¼**

---

## ä¸»è¦åŠŸèƒ½ âœ¨

| åŠŸèƒ½ | æè¿° | æŠ€æœ¯äº®ç‚¹ |
|------|------|----------|
| **å…¨çƒç–«æƒ…æ¦‚è§ˆ** | æ˜¾ç¤ºå…¨çƒç´¯è®¡ç¡®è¯Šã€æ­»äº¡ã€åº·å¤ã€æ´»è·ƒç—…ä¾‹ç­‰ç»Ÿè®¡æ•°æ® | Riverpod StateNotifier + AsyncValue |
| **å›½å®¶è¶‹åŠ¿å›¾è¡¨** | ä½¿ç”¨æŠ˜çº¿å›¾å±•ç¤ºç‰¹å®šå›½å®¶çš„æ¯æ—¥ç—…ä¾‹ã€æ­»äº¡ã€åº·å¤è¶‹åŠ¿ | fl_chart + å“åº”å¼æ•°æ®æµ |
| **å›½å®¶åˆ—è¡¨** | ä»¥æŠ˜å åˆ—è¡¨çš„å½¢å¼å±•ç¤ºæ‰€æœ‰å—å½±å“å›½å®¶çš„è¯¦ç»†æ•°æ® | ListView.builder + æŠ˜å åŠ¨ç”» |
| **æœç´¢åŠŸèƒ½** | æ”¯æŒæŒ‰å›½å®¶åç§°å®æ—¶æœç´¢ï¼Œå¿«é€ŸæŸ¥çœ‹ç‰¹å®šå›½å®¶æ•°æ® | SearchDelegate + Riverpod |
| **ä¸‹æ‹‰åˆ·æ–°** | æ”¯æŒä¸‹æ‹‰è·å–æœ€æ–°ç–«æƒ…æ•°æ® | RefreshIndicator + AsyncValue |
| **æ·±è‰²ä¸»é¢˜** | é‡‡ç”¨Material Designæ·±è‰²ä¸»é¢˜ï¼Œè§†è§‰ä½“éªŒè‰¯å¥½ | ThemeData + Provider |

---

## ä¼ä¸šçº§æ¶æ„ ğŸ—ï¸

### æ¶æ„åˆ†å±‚å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Presentation Layer           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Screens   â”‚ â”‚   Widgets   â”‚            â”‚
â”‚  â”‚  (UIå±‚)      â”‚ â”‚  (ç»„ä»¶å±‚)    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚
          â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 State Layer                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚      Riverpod Providers              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  StateNotifierâ”‚  â”‚   FutureProvider  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Domain Layer                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Repositories â”‚  â”‚   Services   â”‚        â”‚
â”‚  â”‚  (æ•°æ®ä»“åº“)   â”‚  â”‚   (æœåŠ¡å±‚)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚
          â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Data Layer                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  DioClient   â”‚  â”‚ SharedPrefs  â”‚        â”‚
â”‚  â”‚  (ç½‘ç»œå±‚)     â”‚  â”‚   (æœ¬åœ°å­˜å‚¨)  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| åŠŸèƒ½ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | Web å¯¹æ¯” | é€‰å‹ç†ç”± |
|------|----------|------|----------|----------|
| **çŠ¶æ€ç®¡ç†** | flutter_riverpod | ^2.6.1 | Zustand/Pinia | ç¼–è¯‘æ—¶å®‰å…¨ã€è‡ªåŠ¨ä¾èµ–è¿½è¸ªã€å†…ç½®DI |
| **ä»£ç ç”Ÿæˆ** | riverpod_generator | ^2.6.5 | - | è‡ªåŠ¨ç”ŸæˆProviderï¼Œå‡å°‘70%æ ·æ¿ä»£ç  |
| **ç½‘ç»œè¯·æ±‚** | dio | ^5.9.1 | Axios/Fetch | æ‹¦æˆªå™¨ã€è¯·æ±‚å–æ¶ˆã€FormData |
| **è·¯ç”±ç®¡ç†** | go_router | ^17.0.1 | React Router v6 | å£°æ˜å¼è·¯ç”±ã€æ·±é“¾æ¥ |
| **ä¾èµ–æ³¨å…¥** | Riverpod Generator | ^2.6.5 | Provider/Inversify | é›¶å¼€é”€ã€ç¼–è¯‘æ—¶æ£€æŸ¥ã€è‡ªåŠ¨æ³¨å…¥ |
| **æ—¥å¿—ç³»ç»Ÿ** | logger | ^2.6.2 | Winston/Pino | å½©è‰²è¾“å‡ºã€åˆ†çº§ |
| **å›¾è¡¨** | fl_chart | ^1.1.0 | Recharts | é«˜æ€§èƒ½ã€è§¦æ‘¸äº¤äº’ |
| **ç¯å¢ƒé…ç½®** | flutter_dotenv | ^6.0.0 | dotenv | å¤šç¯å¢ƒæ”¯æŒ |

---

## é¡¹ç›®ç»“æ„ ğŸ“ï¼ˆ2026 Riverpod Generator æ¶æ„ï¼‰

```
lib/
â”œâ”€â”€ config/                      # é…ç½®å±‚
â”‚   â”œâ”€â”€ app_config.dart          # åº”ç”¨é…ç½®ï¼ˆAPIã€è¶…æ—¶ã€ä¸»é¢˜ï¼‰
â”‚   â”œâ”€â”€ colors.dart             # é¢œè‰²å¸¸é‡
â”‚   â””â”€â”€ constants.dart          # ä¸šåŠ¡å¸¸é‡
â”‚
â”œâ”€â”€ core/                       # æ ¸å¿ƒåŠŸèƒ½å±‚
â”‚   â”œâ”€â”€ errors/                # é”™è¯¯å¤„ç†
â”‚   â”‚   â””â”€â”€ app_error.dart        # é”™è¯¯åˆ†ç±»
â”‚   â””â”€â”€ network/               # ç½‘ç»œåŸºç¡€è®¾æ–½
â”‚       â””â”€â”€ dio_client.dart    # Dio å•ä¾‹é…ç½®ã€æ‹¦æˆªå™¨
â”‚
â”œâ”€â”€ notifiers/                  # çŠ¶æ€ç®¡ç†å™¨ï¼ˆ@riverpod æ³¨è§£ï¼‰
â”‚   â”œâ”€â”€ country_list_notifier.dart    # å›½å®¶åˆ—è¡¨çŠ¶æ€
â”‚   â”œâ”€â”€ country_list_notifier.g.dart  # ç”Ÿæˆçš„Provider
â”‚   â”œâ”€â”€ global_stats_notifier.dart   # å…¨çƒç»Ÿè®¡çŠ¶æ€
â”‚   â””â”€â”€ global_stats_notifier.g.dart # ç”Ÿæˆçš„Provider
â”‚
â”œâ”€â”€ repositories/               # æ•°æ®ä»“åº“å±‚
â”‚   â””â”€â”€ covid_repository.dart   # ä»“åº“ï¼ˆæ¥å£+å®ç°ï¼‰
â”‚
â”œâ”€â”€ screens/                    # é¡µé¢å±‚
â”‚   â”œâ”€â”€ global_stats.dart       # å…¨çƒç»Ÿè®¡é¡µé¢
â”‚   â”œâ”€â”€ country_list.dart       # å›½å®¶åˆ—è¡¨é¡µé¢
â”‚   â”œâ”€â”€ country_search.dart    # æœç´¢é¡µé¢
â”‚   â””â”€â”€ test_demo.dart         # æµ‹è¯•æ¼”ç¤ºé¡µé¢
â”‚
â”œâ”€â”€ widgets/                    # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ drawer.dart            # ä¾§è¾¹æ 
â”‚   â”œâ”€â”€ folding_cell.dart      # æŠ˜å å•å…ƒæ ¼
â”‚   â”œâ”€â”€ graph.dart            # æŠ˜çº¿å›¾è¡¨
â”‚   â””â”€â”€ info_card.dart        # ä¿¡æ¯å¡ç‰‡
â”‚
â”œâ”€â”€ router.dart                 # æ ¸å¿ƒProviderå®šä¹‰ï¼ˆLogger + Repository + Routerï¼‰
â”œâ”€â”€ router.g.dart               # ç”Ÿæˆçš„Providerä»£ç 
â””â”€â”€ main.dart                   # åº”ç”¨å…¥å£
```

### æ¶æ„è¯´æ˜

**2026 Riverpod Generator æ–°æ¶æ„ç‰¹ç‚¹ï¼š**

1. **ç§»é™¤ providers/ ç›®å½•** - ä¸å†éœ€è¦æ‰‹åŠ¨å£°æ˜ Provider
2. **æ–°å¢ router.dart** - é›†ä¸­å®šä¹‰æ ¸å¿ƒä¾èµ–ï¼ˆLoggerã€Repositoryã€Routerï¼‰
3. **notifiers/ åŒ…å« .g.dart æ–‡ä»¶** - ä»£ç ç”Ÿæˆå™¨è‡ªåŠ¨åˆ›å»º Provider
4. **é›¶æ ·æ¿ä»£ç ** - é€šè¿‡ `@riverpod` æ³¨è§£è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰Provider

---

## å¿«é€Ÿå¼€å§‹ ğŸš€

### ç¯å¢ƒè¦æ±‚

| å·¥å…· | æœ€ä½ç‰ˆæœ¬ | æ¨èç‰ˆæœ¬ |
|------|----------|----------|
| Flutter SDK | 3.8.0 | æœ€æ–°ç¨³å®šç‰ˆ |
| Dart SDK | 3.0.0 | éšFlutterä¸€èµ· |
| Android Studio / VS Code | æœ€æ–° | æœ€æ–° |

### å®‰è£…æ­¥éª¤

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd helloFluDemo

# 2. å®‰è£…ä¾èµ–
flutter pub get

# 3. è¿è¡Œåº”ç”¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
flutter run

# 4. æˆ–è€…è¿è¡Œç‰¹å®šå¹³å°
flutter run -d android
flutter run -d ios
flutter run -d chrome --web-port=30000  # å›ºå®šç«¯å£é¿å…å¤šå®ä¾‹
```

---

## ä¼˜åŒ–äº®ç‚¹ ğŸ¯

### âœ… 1. æ—¥å¿—ç³»ç»Ÿç»Ÿä¸€åŒ–
- ç§»é™¤ `print()`ï¼Œç»Ÿä¸€ä½¿ç”¨ `Logger`
- æ ¹æ® `AppConfig.enableLogging` åŠ¨æ€å¯ç”¨/ç¦ç”¨
- DioClient ç½‘ç»œæ—¥å¿—é›†æˆ

### âœ… 2. ç¯å¢ƒå˜é‡ç”Ÿæ•ˆåŒ–
- `.env` é…ç½®çœŸæ­£ç”Ÿæ•ˆ
- æ”¯æŒç”Ÿäº§ç¯å¢ƒç¦ç”¨æ—¥å¿—

### âœ… 3. APIå±‚ä¸Repositoryå±‚åˆå¹¶
- åˆ é™¤é‡å¤çš„ ApiService
- ç»Ÿä¸€ä½¿ç”¨ Repository å±‚
- æ¶æ„æ›´æ¸…æ™°

### âœ… 4. é”™è¯¯åˆ†ç±»å¤„ç†
- 7ç§é”™è¯¯ç±»å‹ï¼šNetworkError, ServerError, ClientError, TimeoutError, CacheError, DataParseError, UnknownError
- è‡ªåŠ¨è½¬æ¢ DioException
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

---

## æ•°æ®æµæ¶æ„ ğŸ“Š

```
User Action
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     UI        â”‚
â”‚  (Screen)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ ref.watch()
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Provider    â”‚
â”‚ (StateNotifier)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Repository   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API (Dio)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API æ–‡æ¡£ ğŸ“¡

æœ¬é¡¹ç›®ä½¿ç”¨ [disease.sh](https://disease.sh/) å…è´¹ COVID-19 APIã€‚

### ç«¯ç‚¹åˆ—è¡¨

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/all` | GET | å…¨çƒç»Ÿè®¡æ•°æ® |
| `/countries` | GET | æ‰€æœ‰å›½å®¶åˆ—è¡¨ |
| `/countries/{name}` | GET | ç‰¹å®šå›½å®¶è¯¦æƒ… |
| `/historical/{name}` | GET | å†å²æ•°æ® |

### å“åº”ç¤ºä¾‹

```json
{
  "updated": 1704067200000,
  "cases": 700000000,
  "todayCases": 100000,
  "deaths": 7000000,
  "recovered": 650000000,
  "active": 43000000,
  "affectedCountries": 230
}
```

---

## å¼€å‘æŒ‡å— ğŸ“š

### æ·»åŠ æ–°åŠŸèƒ½æµç¨‹

```
1. æ·»åŠ ä»“åº“æ–¹æ³• (repositories/)
        â†“
2. åˆ›å»º StateNotifier (notifiers/)
        â†“
3. æ³¨å†Œ Provider (providers/providers.dart)
        â†“
4. å®ç° UI é¡µé¢ (screens/)
        â†“
5. æ·»åŠ è·¯ç”± (providers/providers.dart routerProvider)
        â†“
6. è¿è¡Œåˆ†æ (flutter analyze)
```

---

## å¸¸è§é—®é¢˜ â“

### Q: å¦‚ä½•åˆ‡æ¢ä¸»é¢˜ï¼Ÿ

A: ä¿®æ”¹ `AppConfig.darkTheme` æˆ–é€šè¿‡ `themeProvider` åˆ‡æ¢ã€‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„APIç«¯ç‚¹ï¼Ÿ

A: ä¸‰æ­¥èµ°ï¼š
1. åœ¨ `CovidRepository` æ¥å£æ·»åŠ æ–¹æ³•
2. åœ¨ `CovidRepositoryImpl` å®ç°é€»è¾‘
3. åœ¨ Notifier ä¸­è°ƒç”¨

---

**Happy Coding! ğŸ‰ æ„¿ä»£ç æ— Bugï¼Œåº”ç”¨æ— Crashï¼**
